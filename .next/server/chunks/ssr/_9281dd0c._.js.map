{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/hasanalmahadi/WebProject/medimeet/actions/onboarding.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/prisma\";\nimport { auth } from \"@clerk/nextjs/server\";\nimport { revalidatePath } from \"next/cache\";\n\n/**\n * Sets the user's role and related information\n */\nexport async function setUserRole(formData) {\n  const { userId } = await auth();\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  // Find user in our database\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) throw new Error(\"User not found in database\");\n\n  const role = formData.get(\"role\");\n\n  if (!role || ![\"PATIENT\", \"DOCTOR\"].includes(role)) {\n    throw new Error(\"Invalid role selection\");\n  }\n\n  try {\n    // For patient role - simple update\n    if (role === \"PATIENT\") {\n      await db.user.update({\n        where: {\n          clerkUserId: userId,\n        },\n        data: {\n          role: \"PATIENT\",\n        },\n      });\n\n      revalidatePath(\"/\");\n      return { success: true, redirect: \"/doctors\" };\n    }\n\n    // For doctor role - need additional information\n    if (role === \"DOCTOR\") {\n      const specialty = formData.get(\"specialty\");\n      const experience = parseInt(formData.get(\"experience\"), 10);\n      const credentialUrl = formData.get(\"credentialUrl\");\n      const description = formData.get(\"description\");\n\n      // Validate inputs\n      if (!specialty || !experience || !credentialUrl || !description) {\n        throw new Error(\"All fields are required\");\n      }\n\n      await db.user.update({\n        where: {\n          clerkUserId: userId,\n        },\n        data: {\n          role: \"DOCTOR\",\n          specialty,\n          experience,\n          credentialUrl,\n          description,\n          verificationStatus: \"PENDING\",\n        },\n      });\n\n      revalidatePath(\"/\");\n      return { success: true, redirect: \"/doctor/verification\" };\n    }\n  } catch (error) {\n    console.error(\"Failed to set user role:\", error);\n    throw new Error(`Failed to update user profile: ${error.message}`);\n  }\n}\n\n/**\n * Gets the current user's complete profile information\n */\nexport async function getCurrentUser() {\n  const { userId } = await auth();\n\n  if (!userId) {\n    return null;\n  }\n\n  try {\n    const user = await db.user.findUnique({\n      where: {\n        clerkUserId: userId,\n      },\n    });\n\n    return user;\n  } catch (error) {\n    console.error(\"Failed to get user information:\", error);\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AACA;;;;;;;AAKO,eAAe,YAAY,QAAQ;IACxC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE5B,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,4BAA4B;IAC5B,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QACpC,OAAO;YAAE,aAAa;QAAO;IAC/B;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,MAAM,OAAO,SAAS,GAAG,CAAC;IAE1B,IAAI,CAAC,QAAQ,CAAC;QAAC;QAAW;KAAS,CAAC,QAAQ,CAAC,OAAO;QAClD,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,mCAAmC;QACnC,IAAI,SAAS,WAAW;YACtB,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;gBACnB,OAAO;oBACL,aAAa;gBACf;gBACA,MAAM;oBACJ,MAAM;gBACR;YACF;YAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;YACf,OAAO;gBAAE,SAAS;gBAAM,UAAU;YAAW;QAC/C;QAEA,gDAAgD;QAChD,IAAI,SAAS,UAAU;YACrB,MAAM,YAAY,SAAS,GAAG,CAAC;YAC/B,MAAM,aAAa,SAAS,SAAS,GAAG,CAAC,eAAe;YACxD,MAAM,gBAAgB,SAAS,GAAG,CAAC;YACnC,MAAM,cAAc,SAAS,GAAG,CAAC;YAEjC,kBAAkB;YAClB,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,iBAAiB,CAAC,aAAa;gBAC/D,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;gBACnB,OAAO;oBACL,aAAa;gBACf;gBACA,MAAM;oBACJ,MAAM;oBACN;oBACA;oBACA;oBACA;oBACA,oBAAoB;gBACtB;YACF;YAEA,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;YACf,OAAO;gBAAE,SAAS;gBAAM,UAAU;YAAuB;QAC3D;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,MAAM,IAAI,MAAM,CAAC,+BAA+B,EAAE,MAAM,OAAO,EAAE;IACnE;AACF;AAKO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE5B,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YACpC,OAAO;gBACL,aAAa;YACf;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;;;IA7FsB;IA0EA;;AA1EA,+OAAA;AA0EA,+OAAA","debugId":null}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///Users/hasanalmahadi/WebProject/medimeet/app/%28main%29/onboarding/layout.js"],"sourcesContent":["import { getCurrentUser } from \"@/actions/onboarding\";\nimport { redirect } from \"next/navigation\";\n\nexport const metadata = {\n  title: \"Onboarding - MediMeet\",\n  description: \"Complete your profile to get started with MediMeet\",\n};\n\nexport default async function OnboardingLayout({ children }) {\n  // Get complete user profile\n  const user = await getCurrentUser();\n\n  // Redirect users who have already completed onboarding\n  if (user) {\n    if (user.role === \"PATIENT\") {\n      redirect(\"/doctors\");\n    } else if (user.role === \"DOCTOR\") {\n      // Check verification status for doctors\n      if (user.verificationStatus === \"VERIFIED\") {\n        redirect(\"/doctor\");\n      } else {\n        redirect(\"/doctor/verification\");\n      }\n    } else if (user.role === \"ADMIN\") {\n      redirect(\"/admin\");\n    }\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-12\">\n      <div className=\"max-w-3xl mx-auto\">\n        <div className=\"text-center mb-10\">\n          <h1 className=\"text-3xl font-bold text-white mb-2\">\n            Welcome to MediMeet\n          </h1>\n          <p className=\"text-muted-foreground text-lg\">\n            Tell us how you want to use the platform\n          </p>\n        </div>\n\n        {children}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;;;;AAEO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe,iBAAiB,EAAE,QAAQ,EAAE;IACzD,4BAA4B;IAC5B,MAAM,OAAO,MAAM,CAAA,GAAA,qHAAA,CAAA,iBAAc,AAAD;IAEhC,uDAAuD;IACvD,IAAI,MAAM;QACR,IAAI,KAAK,IAAI,KAAK,WAAW;YAC3B,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;QACX,OAAO,IAAI,KAAK,IAAI,KAAK,UAAU;YACjC,wCAAwC;YACxC,IAAI,KAAK,kBAAkB,KAAK,YAAY;gBAC1C,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;YACX,OAAO;gBACL,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;YACX;QACF,OAAO,IAAI,KAAK,IAAI,KAAK,SAAS;YAChC,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;QACX;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAqC;;;;;;sCAGnD,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;;;;;;;gBAK9C;;;;;;;;;;;;AAIT","debugId":null}}]
}